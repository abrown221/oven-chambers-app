<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oven Chambers App</title>
  <style>
    /* Body as a flex container, centered, with light gray background */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      box-sizing: border-box;
      font-family: sans-serif;
      background-color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    body {
      flex-direction: column; /* So the heading is on top, then the grid */
    }

    /* Main heading styles (centered, large font) */
    h1 {
      text-align: center;
      font-size: 2em;
      margin: 20px 0;
    }

    /* Container for all ovens (3 columns by 2 rows) */
    .mainContainer {
      display: grid;
      grid-template-columns: repeat(3, auto);
      grid-template-rows: repeat(2, auto);
      gap: 30px; /* 30px gap horizontally and vertically */
      margin-bottom: 30px; /* Some bottom space */
    }

    /* Each oven group */
    .ovenGroup {
      width: 300px;
      border: 4px solid #000;
      background-color: #fff;
      padding: 10px;
    }

    .ovenGroup h2 {
      margin: 0 0 10px 0; /* Some space below the oven title */
      font-size: 1.2em;
    }

    /* Chambers container inside each oven (4 vertical chambers) */
    .groupGrid {
      display: flex;
      flex-direction: column;
    }

    /* Each chamber is a .square with specific styling */
    .square {
      height: 88px; /* Half the original 175px */
      width: 100%;
      border: 2px solid #333;
      border-radius: 6px;
      background-color: green;
      color: magenta;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin-bottom: 0; /* Default no bottom margin */
    }

    /* Add 20px vertical gap ONLY under the 2nd chamber in each group */
    .square:nth-child(2) {
      margin-bottom: 20px;
    }

    /* Timer, chamber-number, and status lines */
    .timer {
      font-size: 1.0em;
      margin: 2px 0;
    }
    .chamber-number {
      font-weight: bold;
      margin: 2px 0;
    }
    .status-message {
      /* Make the third line much bigger */
      font-size: 1.4em;
      margin: 2px 0;
      text-align: center;
      padding: 0 5px;
    }
  </style>
</head>
<body>
  <h1>OVEN KING AT ANDY'S</h1>

  <!-- Main container for the 6 ovens -->
  <div class="mainContainer">
    <!-- Oven 1 -->
    <div class="ovenGroup">
      <h2>Oven 1</h2>
      <div class="groupGrid">
        <!-- Chambers #1..4 -->
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #1</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #2</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #3</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #4</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
      </div>
    </div>

    <!-- Oven 2 -->
    <div class="ovenGroup">
      <h2>Oven 2</h2>
      <div class="groupGrid">
        <!-- Chambers #5..8 -->
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #5</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #6</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #7</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #8</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
      </div>
    </div>

    <!-- Oven 3 -->
    <div class="ovenGroup">
      <h2>Oven 3</h2>
      <div class="groupGrid">
        <!-- Chambers #9..12 -->
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #9</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #10</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #11</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #12</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
      </div>
    </div>

    <!-- Oven 4 -->
    <div class="ovenGroup">
      <h2>Oven 4</h2>
      <div class="groupGrid">
        <!-- Chambers #13..16 -->
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #13</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #14</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #15</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #16</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
      </div>
    </div>

    <!-- Oven 5 -->
    <div class="ovenGroup">
      <h2>Oven 5</h2>
      <div class="groupGrid">
        <!-- Chambers #17..20 -->
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #17</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #18</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #19</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #20</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
      </div>
    </div>

    <!-- Oven 6 -->
    <div class="ovenGroup">
      <h2>Oven 6</h2>
      <div class="groupGrid">
        <!-- Chambers #21..24 -->
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #21</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #22</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #23</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
        <div class="square">
          <div class="timer">00:00</div>
          <div class="chamber-number">Chamber #24</div>
          <div class="status-message">Ready for pizza!</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Updated stage definitions with no color references in the text
    const STAGE_DEFS = [
      {
        bg: 'green',
        color: 'magenta',
        message: 'Ready for pizza!'
      },
      {
        bg: 'blue',
        color: 'yellow',
        message: 'Pizza Cooking'
      },
      {
        bg: 'yellow',
        color: 'blue',
        message: 'Spin me and check the bottom!'
      },
      {
        bg: 'blue',
        color: 'yellow',
        message: 'Pizza Cooking'
      },
      {
        bg: 'red',
        color: 'cyan',
        message: 'PIZZA READY OR ALMOST READY! CHECK ME!'
      },
      {
        bg: 'blue',
        color: 'yellow',
        message: 'Oven reheating'
      }
    ];

    const NUM_CHAMBERS = 24;
    const chambersData = [];
    for (let i = 0; i < NUM_CHAMBERS; i++) {
      chambersData.push({
        stage: 0,      // 0..5
        startTime: 0   // timestamp in ms when stage 1 starts
      });
    }

    const squares = document.querySelectorAll('.square');

    // Click handler: move stage forward, handle timer resets
    squares.forEach((square, index) => {
      square.addEventListener('click', () => handleChamberClick(index));
    });

    function handleChamberClick(index) {
      let chamber = chambersData[index];
      // Advance stage by 1 (wrap around with % 6)
      chamber.stage = (chamber.stage + 1) % 6;

      // If we moved from stage 0->1, record the start time
      if (chamber.stage === 1) {
        chamber.startTime = Date.now();
      }
      // If we returned to stage 0, reset startTime
      else if (chamber.stage === 0) {
        chamber.startTime = 0;
      }

      updateChamberUI(index);
    }

    function updateChamberUI(index) {
      const square = squares[index];
      const timerDiv = square.querySelector('.timer');
      const statusDiv = square.querySelector('.status-message');
      const chamber = chambersData[index];
      const stageInfo = STAGE_DEFS[chamber.stage];

      // Update background and text color based on stage
      square.style.backgroundColor = stageInfo.bg;
      square.style.color = stageInfo.color;

      // Update status message
      statusDiv.textContent = stageInfo.message;

      // Timer
      if (chamber.stage === 0) {
        // Inactive
        timerDiv.textContent = '00:00';
      } else {
        const now = Date.now();
        const elapsedSec = Math.floor((now - chamber.startTime) / 1000);
        timerDiv.textContent = formatTime(elapsedSec);
      }
    }

    function formatTime(totalSeconds) {
      const mm = Math.floor(totalSeconds / 60);
      const ss = totalSeconds % 60;
      return String(mm).padStart(2, '0') + ':' + String(ss).padStart(2, '0');
    }

    // Auto-update loop for time-based transitions
    function updateLoop() {
      const now = Date.now();
      for (let i = 0; i < NUM_CHAMBERS; i++) {
        let chamber = chambersData[i];
        if (chamber.stage > 0) {
          const elapsedSec = Math.floor((now - chamber.startTime) / 1000);

          // Stage transitions at exact times:
          // 3 minutes (180s) from stage 1 -> 2
          if (chamber.stage === 1 && elapsedSec >= 180) {
            chamber.stage = 2;
          }

          // 6 minutes (360s) from stage 2 or 3 -> 4
          if ((chamber.stage === 2 || chamber.stage === 3) && elapsedSec >= 360) {
            chamber.stage = 4;
          }

          // 10 minutes (600s) any active stage -> 0
          if (chamber.stage > 0 && elapsedSec >= 600) {
            chamber.stage = 0;
            chamber.startTime = 0;
          }

          // Update UI after potential stage changes
          updateChamberUI(i);
        }
      }
    }

    setInterval(updateLoop, 1000);
  </script>
</body>
</html>
